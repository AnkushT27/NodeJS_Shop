<%- include('../shared/head.ejs') %> 
<link rel="stylesheet" href="/css/main.css">
<link rel="stylesheet" href="/css/product.css">
<link rel="stylesheet" href="/css/forms..css">
</head>

<body> 
<%- include('../shared/nav.ejs') %>  

    <main>
            <% if(products.length > 0) { %>
         <div class="grid">
           <% products.forEach((product) => { %>
            <article class="card product-item">
                <header class="card__header">
                    <h1 class="product__title"><%=product.title%></h1>
                </header>
                <div class="card__image">
                    <img src="<%=product.url%>" alt="A Book">
                </div>
                <div class="card__content">
                    <h2 class="product__price">$<%=product.price%></h2>
                    <p class="product__description"><%=product.desc%></p>
                </div>
                <div class="card__actions">
                <a class="btn" href="/product-details/<%=product._id%>" role="button">Details</a>
                <% 
                    if(isAuth){
                %>
                    <form action="/cart" method="POST">
                        <input type="hidden" name="_csrf" value="<%= csrftoken%>"/>
                        <button class="btn" type="submit">Add To Cart</button>
                        <input type="hidden" name="productid" value="<%=product._id%>"/>
                    </form>
                    <% 
                    }
                    %>
                </div>
            </article>
            <section class="pagination">
            <%
             });
             for(var i=1;i<=limit;i++)
             {
            %>
            
            <a href="?page=<%=i%>" class="<%= currentPage == i ? 'active':''%>"><%=i%></a>
            <% 
            }
            %>
            </section>
            <% 
             }
            else
            {
            %>
            <h1>No Product Found</h1>
            <%
             }
            %>
        </div>
    </main>
    <%- include('../shared/end.ejs') %>  